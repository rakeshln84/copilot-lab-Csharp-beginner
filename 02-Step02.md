# Create CRUD Operations for Music Store

In this step, we will create a simple Music Store application that allows us to manage albums. We will create a class for the Album and Genre models, and then create a MusicStoreService class that will allow us to perform CRUD operations on the albums.

1. Let's start by creating a class for the Album model.

   You can use slash command `/new` to create a new class. For example, you can type `/new Create a class for the Album model` to create a new class for the Album model.
   Click on the `Create` button to create the new file under `Models` folder.

   ![image](https://github.com/user-attachments/assets/e2e2fee3-2160-46d1-bced-1898cbb8b926)

   The `Album` class should have the following properties:

   ```csharp

       public class Album
       {
           public int Id { get; set; }
           public string Title { get; set; }
           public string Artist { get; set; }
           public DateTime ReleaseDate { get; set; }
           public string Genre { get; set; }

           public Album(int id, string title, string artist, DateTime releaseDate, string genre)
           {
               Id = id;
               Title = title;
               Artist = artist;
               ReleaseDate = releaseDate;
               Genre = genre;
           }

           public override string ToString()
           {
               return $"Album: {Title}, Artist: {Artist}, Released: {ReleaseDate.ToShortDateString()}, Genre: {Genre}";
           }
       }

   ```

2. Next, let's create a class for the Genre model.

   This time, create a new file `Genre.cs` in the `Models` folder.
   When you start typing the class name, you can the inline suggestion from Copilot to complete the class for you.

   ![image](https://github.com/user-attachments/assets/6e072689-cc38-471c-8917-95a7ac784113)

   The `Genre` class should have the following properties:

   ```csharp

   public class Genre
   {
       public int Id { get; set; }
       public string Name { get; set; }

       public Genre(int id, string name)
       {
           Id = id;
           Name = name;
       }

       public override string ToString()
       {
           return $"Genre: {Name}";
       }
   }

   ```

3. Modify the Album class to use the Genre model.
   Replace the `Genre` property in the `Album` class from `string` to type `Genre`.
   Use the inline suggestion from Copilot to update the `Album` class.

   ![image](https://github.com/user-attachments/assets/07c6ce78-67ba-4d64-8122-98bf08b2d351)

   ```csharp

       public class Album
       {
           public int Id { get; set; }
           public string Title { get; set; }
           public string Artist { get; set; }
           public DateTime ReleaseDate { get; set; }
           public Genre Genre { get; set; }

           public Album(int id, string title, string artist, DateTime releaseDate, Genre genre)
           {
               Id = id;
               Title = title;
               Artist = artist;
               ReleaseDate = releaseDate;
               Genre = genre;
           }

           public override string ToString()
           {
               return $"Album: {Title}, Artist: {Artist}, Released: {ReleaseDate.ToShortDateString()}, Genre: {Genre.Name}";
           }
       }

   ```

4. Create a new file `MusicStoreService.cs`. Use Copilot to generate the CRUD operations for the Music Store.
   You can do this in different ways, such as providing top level comments on the file, or start typing the method names and let Copilot generate the code for you.

   The top level comments can be used to provide a brief description of the class and its purpose. For example:

   ```csharp

       /// <summary>
       /// Service class for managing CRUD operations on the Music Store.
       /// </summary>

   ```

   Your `MusicStoreService` class should look like this:

   ```csharp

       public class MusicStoreService
       {
           private List<Album> _albums;

           public List<Album> GetAlbums()
           {
               return _albums;
           }

           public Album GetAlbum(int id)
           {
               return _albums.FirstOrDefault(a => a.Id == id);
           }

           public void AddAlbum(Album album)
           {
               _albums.Add(album);
           }

           public void UpdateAlbum(Album album)
           {
               var existingAlbum = _albums.FirstOrDefault(a => a.Id == album.Id);
               if (existingAlbum != null)
               {
                   existingAlbum.Title = album.Title;
                   existingAlbum.Artist = album.Artist;
                   existingAlbum.ReleaseDate = album.ReleaseDate;
                   existingAlbum.Genre = album.Genre;
               }
           }

           public void DeleteAlbum(int id)
           {
               var album = _albums.FirstOrDefault(a => a.Id == id);
               if (album != null)
               {
                   _albums.Remove(album);
               }
           }
       }

   ```

5. Add mock data to the `MusicStoreService` class to test the CRUD operations by copying the following code snippet to the constructor of the `MusicStoreService` class.

   ```csharp

       public MusicStoreService()
       {
           _albums = new List<Album>
           {
               new Album(1, "The Dark Side of the Moon", "Pink Floyd", new DateTime(1973, 3, 1), new Genre(1, "Rock")),
               new Album(2, "Thriller", "Michael Jackson", new DateTime(1982, 11, 30), new Genre(2, "Pop")),
               new Album(3, "Kind of Blue", "Miles Davis", new DateTime(1959, 8, 17), new Genre(3, "Jazz"))
           };
       }

   ```

   You can use Copilot to generate more albums. When you click enter, Copilot will generate more albums for you.

   ![image](https://github.com/user-attachments/assets/baec4c0e-6b05-4b49-86d5-84b33040690d)

6. Modify the `Program.cs` file to use the new repository and print the album title.
   Use Copilot to modify the `Program.cs` file . Add reference to the `MusicStoreService` file in your prompt.

   ![image](https://github.com/user-attachments/assets/735f84cc-d6af-4860-bc09-429a6d9e4557)

   The `Program.cs` file should look like this:

   ```csharp

      public static void Main(string[] args)
       {
           // Instantiate the repository
           var musicStoreService = new MusicStoreService();

           // Get all albums
           var albums = musicStoreService.GetAlbums();

           // Print all albums
           foreach (var album in albums)
           {
               Console.WriteLine(album.Title);
           }
       }
   ```

7. Run the application by typing `dotnet run` in the terminal. You should see the list of albums printed on the console.

8. Add more methods to the `MusicStoreService` class to search albums by title, artist, and genre using Copilot.

   - SearchAlbumsByTitle
   - SearchAlbumsByArtist
   - SearchAlbumsByGenre

   The methods should look like this:

   ```csharp

   public List<Album> SearchAlbumsByTitle(string title)
   {
       return _albums.Where(a => a.Title == title).ToList();
   }

   public List<Album> SearchAlbumsByArtist(string artist)
   {
       return _albums.Where(a => a.Artist == artist).ToList();
   }

   public List<Album>SearchAlbumsByGenre(string genre)
   {
       var genreId = _albums.FirstOrDefault(a => a.Genre.Name == genre)?.Genre.Id;
       if (genreId != null)
           return _albums.Where(a => a.Genre.Id == genreId).ToList();
       return new List<Album>();
   }

   ```

[Create CRUD Operations for Music Store](./02-Step02.md) | [Refactoring the code](./03-Step03.md)
