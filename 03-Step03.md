# Refactoring Music Store

use copilot to refactor all search methods to ignore case

```csharp

  public List<Album> SearchAlbumsByArtist(string artist)
 {
     return _albums.Where(a => a.Artist.Equals(artist, StringComparison.OrdinalIgnoreCase)).ToList();
 }

 public List<Album> SearchAlbumsByTitle(string title)
 {
     return _albums.Where(a => a.Title.Equals(title, StringComparison.OrdinalIgnoreCase)).ToList();
 }

```

modify the add album method to check if the album already exists

```csharp

  public void AddAlbum(Album album)
 {
     if (_albums.Any(a => a.Id == album.Id))
     {
         throw new Exception("Album already exists");
     }

     _albums.Add(album);
 }

```

use copilot to create a custom exception class

```csharp

  public class AlbumAlreadyExistsException : Exception
 {
     public AlbumAlreadyExistsException(string message) : base(message)
     {
     }
 }

```

use copilot to modify the add album method to throw the custom exception

```csharp

  public void AddAlbum(Album album)
 {
     if (_albums.Any(a => a.Id == album.Id))
     {
         throw new AlbumAlreadyExistsException("Album already exists");
     }

     _albums.Add(album);
 }

```

use copilot to add a new method to print the albums

```csharp

         public static void PrintAlbums(List<Album> albums)
        {
            Console.WriteLine("--------------------------------------------------------------");
            Console.WriteLine("|   ID   |        Title        |       Artist       |   Genre   |");
            Console.WriteLine("--------------------------------------------------------------");
            foreach (var album in albums)
            {
                Console.WriteLine($"| {album.Id,-6} | {album.Title,-19} | {album.Artist,-18} | {album.Genre,-9} |");
            }
            Console.WriteLine("--------------------------------------------------------------");
        }

```

update program file to ask the user with the following options: search albums by artist, title, genre

```csharp

       public static void Main(string[] args)
    {
        // Instantiate the repository
        var musicStoreRepository = new MusicStoreRepository();

        // Get all albums
        var albums = musicStoreRepository.GetAlbums();
        // Print all albums
        PrintAlbums(albums);

        Console.WriteLine();
        Console.WriteLine("****************************************************************");

        Console.WriteLine("Search albums by:");
        Console.WriteLine("1. Artist");
        Console.WriteLine("2. Title");
        Console.WriteLine("3. Genre");

        Console.WriteLine("****************************************************************");

        var option = Console.ReadLine();

        switch (option)
        {
            case "1":
                Console.WriteLine("Enter artist name:");
                var artist = Console.ReadLine();
                var albumsByArtist = musicStoreRepository.SearchAlbumsByArtist(artist);
                PrintAlbums(albumsByArtist);
                break;
            case "2":
                Console.WriteLine("Enter title:");
                var title = Console.ReadLine();
                var albumsByTitle = musicStoreRepository.SearchAlbumsByTitle(title);
                PrintAlbums(albumsByTitle);
                break;
            case "3":
                Console.WriteLine("Enter genre:");
                var genre = Console.ReadLine();
                var albumsByGenre = musicStoreRepository.SearchAlbumsByGenre(genre);
                PrintAlbums(albumsByGenre);
                break;
            default:
                Console.WriteLine("Invalid option");
                break;
        }
    }

```

use explain method to understand the code.

Other challenges you can try:

- Validate the album properties before adding the album
- Partial Search

Remove irrelevant requests
Organize your conversations with threads
